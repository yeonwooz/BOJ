4 3 2 1 bottom=0  M=3  top=3 

0 3 2 1 bottom=1  M=3  top=3 

0 0 2 1 bottom=2  M=3  top=3 

0 0 0 1 bottom=3  M=3  top=3 

4